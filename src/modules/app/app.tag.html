<app>

    <header class="viewer-header">
        <module-selector modules="{ opts.modules }" default-module="{ opts.defaultModule }" on-select="{ setModule }">
            <yield/>
        </module-selector>

        <button class="viewer-button viewer-icon-info-outline { 'is-active': infoIsOpen }"
                title="toggle module info"
                disabled="{ !activeModule.info }"
                onclick="{ toggleInfo }"></button>
        <button class="viewer-button viewer-icon-label" title="toggle annotations"
                disabled></button>

        <size-controls on-resize="{ setSize }" sizes="{ opts.sizes }"/>
    </header>

    <main class="viewer-content">
        <info-panel if="{ infoIsOpen }" sections="{ activeModule.info }" on-close="{ closeInfo }" />

        <iframe class="viewer-frame"
                frameBorder="0"
                sandbox="allow-same-origin allow-scripts allow-forms allow-popups"
                src="{ activeModule.url }"
                width="{ width }"
                height="{ height }"
                ></iframe>
    </main>

    <script>
        var tag = this;
        tag.activeModule = undefined;
        tag.width = window.outerWidth;
        tag.height = window.outerHeight;
        tag.infoIsOpen = false;
        tag.setModule = setModule;
        tag.setSize = setSize;
        tag.closeInfo = closeInfo;
        tag.toggleInfo = toggleInfo;

        function setModule(module) {
            tag.update({ activeModule: module });
        }

        function setSize(width) {
            tag.update({ width: width });
        }

        function closeInfo() {
            tag.update({ infoIsOpen: false });
        }

        function toggleInfo() {
            tag.update({ infoIsOpen: !tag.infoIsOpen });
        }
    </script>

</app>